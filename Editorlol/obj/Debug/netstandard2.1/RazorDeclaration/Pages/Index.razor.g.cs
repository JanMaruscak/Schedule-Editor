#pragma checksum "C:\Users\janma\source\repos\Editorlol\Editorlol\Pages\Index.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "1eae38e11704cb3cbff1f699f1fe9cf4057deed3"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Editorlol.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Editorlol;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\janma\source\repos\Editorlol\Editorlol\_Imports.razor"
using Editorlol.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\janma\source\repos\Editorlol\Editorlol\Pages\Index.razor"
using BlazeCardsCore.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\janma\source\repos\Editorlol\Editorlol\Pages\Index.razor"
using BlazeCardsCore.State;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\janma\source\repos\Editorlol\Editorlol\Pages\Index.razor"
using BlazeCardsCore.Descriptors;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class Index : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 32 "C:\Users\janma\source\repos\Editorlol\Editorlol\Pages\Index.razor"
       
    private CardState cardState;
    List<DateTime> Days = new List<DateTime>
    ();

    int Week = 0;
    int GoneLeft = 0;
    int GoneRight = 0;

    int MarginTop = 0;
    int Height = 1000;
    int Width = 200;

    string CurClass = "T2";
    Dictionary<string, List<List<VerticalListCard>>> Classes = new Dictionary<string, List<List<VerticalListCard>>>();
    Dictionary<string, ClassInfo> ClassInfos = new Dictionary<string, ClassInfo>();

    List<List<VerticalListCard>> Weeks = new List<List<VerticalListCard>>();

    private void DeleteCard()
    {
        //if (this.cardState.Selected is SchoolCard)
        {
            foreach (var item in this.cardState.Selected)
            {
                item.UnhookFromParent();
            }
        }
    }

    void SelectClass(ChangeEventArgs e)
    {
        foreach (var item in Weeks[Week])
        {
            this.cardState.Storage.Cards.Remove(item);
        }

        //Classes[CurClass] = new List<List<VerticalListCard>>();
        //foreach (var item in Weeks)
        //{
        //    Classes[CurClass].Add(item);
        //}

        //Weeks = new List<List<VerticalListCard>>();
        //foreach (var item in Classes[e.Value.ToString()])
        //{
        //    Weeks.Add(item);
        //}

        foreach (var item in Classes[e.Value.ToString()][ClassInfos[e.Value.ToString()].Week])
        {
            this.cardState.Storage.Cards.Add(item);
        }
        Classes[CurClass] = Weeks.ToList();
        Weeks = Classes[e.Value.ToString()].ToList();

        ClassInfos[CurClass].Week = Week;
        ClassInfos[CurClass].GoneLeft = GoneLeft;
        ClassInfos[CurClass].GoneRight = GoneRight;
        ClassInfos[CurClass].Days = Days.ToList();

        Week = ClassInfos[e.Value.ToString()].Week;
        GoneLeft = ClassInfos[e.Value.ToString()].GoneLeft;
        GoneRight = ClassInfos[e.Value.ToString()].GoneRight;
        Days = ClassInfos[e.Value.ToString()].Days.ToList();

        CurClass = e.Value.ToString();

        this.cardState.Canvas.InvokeChange();
    }
    private void AddCard()
    {
        Weeks[Week][0].AddChild(new SchoolCard("VYT", "302", "PN", "14:30-15:45"));
    }
    private void AddBreak()
    {
        Weeks[Week][0].AddChild(new BreakCard());
    }
    private void GoRight()
    {
        if (Week + 1 == Weeks.Count)
        {
            var newWeek = new List<VerticalListCard>
                ();
            for (int i = 0; i < 5; i++)
            {
                newWeek.Add(GetTemplateList(i, Width, MarginTop));
            }
            Weeks.Add(newWeek);

            foreach (var item in Weeks[Week])
            {
                this.cardState.Storage.Cards.Remove(item);
            }

            foreach (var item in newWeek)
            {
                this.cardState.Storage.Cards.Add(item);
            }
            GoneRight++;
        }
        else
        {
            foreach (var item in Weeks[Week])
            {
                this.cardState.Storage.Cards.Remove(item);
            }

            foreach (var item in Weeks[Week + 1])
            {
                this.cardState.Storage.Cards.Add(item);
            }
        }
        for (int i = 0; i < Days.Count; i++)
        {
            Days[i] = Days[i].AddDays(7);
        }
        Week++;
        this.cardState.Canvas.InvokeChange();
    }
    private void GoLeft()
    {
        if (Week == 0)
        {
            var newWeek = new List<VerticalListCard>
                ();
            for (int i = 0; i < 5; i++)
            {
                newWeek.Add(GetTemplateList(i, Width, MarginTop));
            }

            foreach (var item in Weeks[Week])
            {
                this.cardState.Storage.Cards.Remove(item);
            }

            foreach (var item in newWeek)
            {
                this.cardState.Storage.Cards.Add(item);
            }
            Weeks.Insert(0, newWeek);
            GoneLeft--;
        }
        else
        {
            foreach (var item in Weeks[Week])
            {
                this.cardState.Storage.Cards.Remove(item);
            }

            foreach (var item in Weeks[Week - 1])
            {
                this.cardState.Storage.Cards.Add(item);
            }
            Week--;
        }
        for (int i = 0; i < Days.Count; i++)
        {
            Days[i] = Days[i].AddDays(-7);
        }
        this.cardState.Canvas.InvokeChange();
    }

    protected override void OnInitialized()
    {
        for (int x = 0; x < 5; x++)
        {
            Days.Add(DateTime.Now.AddDays(x));
        }
        Classes.Add("T2", Weeks);
        Classes.Add("T1", new List<List<VerticalListCard>>());

        ClassInfos.Add("T2", new ClassInfo(0, 0, 0, Days));
        ClassInfos.Add("T1", new ClassInfo(0, 0, 0, Days));

        Console.WriteLine("oenis");
        Classes["T1"].Add(new List<VerticalListCard>());
        for (int i = 0; i < 5; i++)
        {
            Classes["T1"][0].Add(GetTemplateList(i, Width, MarginTop));
        }
        this.cardState = new CardState();
        Weeks.Add(new List<VerticalListCard>());

        for (int i = 0; i < 5; i++)
        {
            var area = new DropAreaCard();
            area.PositionBehavior.Position = new BlazeCardsCore.Models.Vector2f(i * Width, MarginTop);
            area.SizeBehavior.Size = new BlazeCardsCore.Models.Vector2f(Width, Height);
            area.Clickable = false;
            area.Draggable = false;
            area.Classes.Add("school-background");
            area.Classes.Add(i.ToString());
            area.OnDrop += (o, e) =>
            {
                var index = int.Parse(area.Classes.Last());
                foreach (var item in e.Cards)
                {
                    if (Weeks[Week][index] != item.Parent)
                    {
                        item.UnhookFromParent();
                        Weeks[Week][index].AddChild(item);
                    }

                //if (item is TextCard)
                //{
                //    var downText = item as TextCard;
                //    downText.TextBehavior.Value = downText.PositionBehavior.Position.Y.ToString();
                //}
            }

                foreach (var item in Weeks[Week][index].Children)
                {
                    if (item is SchoolCard)
                    {
                        var sch = item as SchoolCard;
                        sch.Time.TextBehavior.Value = item.PositionBehavior.Position.Y.ToString();
                    }
                }
                foreach (var item in e.Cards[0].Parent.Children)
                {
                    if (item is SchoolCard)
                    {
                        var sch = item as SchoolCard;
                        sch.Time.TextBehavior.Value = item.PositionBehavior.Position.Y.ToString();
                    }
                }
            };
            this.cardState.Storage.Cards.Add(area);
        }
        for (int i = 0; i < 5; i++)
        {
            var schoolCard = new SchoolCard("VYT", "302", "PN", "14:30-15:45");

            var list = new VerticalListCard();
            list.Clickable = false;
            list.Draggable = false;

            list.PositionBehavior.Position = new BlazeCardsCore.Models.Vector2f(i * Width, MarginTop);

            list.AddChild(schoolCard);

            Weeks[0].Add(list);
            this.cardState.Storage.Cards.Add(list);
        }
    }
    private VerticalListCard GetTemplateList(int index, int width, int marginTop)
    {
        VerticalListCard newList = new VerticalListCard();
        newList.Clickable = true;
        newList.Draggable = true;
        newList.PositionBehavior.Position = new BlazeCardsCore.Models.Vector2f(index * width, marginTop);
        return newList;
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
